124,128c124
<   lats[$i]="ark,s,cs:lattice-scale --inv-acoustic-scale=\$[$offset+LMWT] 'ark:gunzip -c $file_list|' ark:- | \
<     lattice-limit-depth ark:- ark:- | \
<     lattice-push --push-strings=false ark:- ark:- | \
<     lattice-align-words-lexicon --max-expand=10.0 \
<       $lang/phones/align_lexicon.int $model ark:- ark:- |"
---
>   lats[$i]="ark:gunzip -c $decode_dir/lat.JOB.gz|"
132a129,140
> lat_wspecifier="ark:|"
> if ! $write_compact; then
>   extra_opts="--determinize-lattice=false"
>   lat_wspecifier="ark:| lattice-determinize-phone-pruned --beam=$lattice_beam --acoustic-scale=$acwt --minimize=$minimize --word-determinize=$word_determinize --write-compact=false $model ark:- ark:- |"
> fi
> 
> if [ "$post_decode_acwt" == 1.0 ]; then
>   lat_wspecifier="$lat_wspecifier gzip -c >$dir/lat.JOB.gz"
> else
>   lat_wspecifier="$lat_wspecifier lattice-scale --acoustic-scale=$post_decode_acwt --write-compact=$write_compact ark:- ark:- | gzip -c >$dir/lat.JOB.gz"
> fi
> 
140,146c148,149
<   $cmd $parallel_opts LMWT=$min_lmwt:$max_lmwt $dir/log/combine_lats.LMWT.log \
<     mkdir -p $dir/ascore_LMWT/ '&&' \
<     lattice-combine --lat-weights=$lat_weights "${lats[@]}" ark:- \| \
<     lattice-to-ctm-conf --decode-mbr=true ark:- - \| \
<     utils/int2sym.pl -f 5 $lang/words.txt  \| \
<     utils/convert_ctm.pl $data/segments $data/reco2file_and_channel \
<     '>' $dir/ascore_LMWT/${ctm_name}.ctm || exit 1;
---
>   $cmd $parallel_opts JOB=1:$nj $dir/log/decode_combine.JOB.log \
>     lattice-combine --acoustic-scale=$acwt --lat-weights=$lat_weights "${lats[@]}" "$lat_wspecifier" || exit 1;
